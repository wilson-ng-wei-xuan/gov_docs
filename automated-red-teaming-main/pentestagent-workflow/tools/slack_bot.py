from dotenv import load_dotenv
import os
import httpx

load_dotenv()

SLACK_BOT_TOKEN = os.environ["SLACK_BOT_TOKEN"]   # xoxb-***
SLACK_CHANNEL_ID = os.environ["SLACK_CHANNEL_ID"] # e.g. C0123456789

async def send_to_slack(text: str) -> None:
    """Send a plain text message to a predefined Slack channel (async)."""
    async with httpx.AsyncClient(timeout=10) as client:
        r = await client.post(
            "https://slack.com/api/chat.postMessage",
            headers={"Authorization": f"Bearer {SLACK_BOT_TOKEN}"},
            json={"channel": SLACK_CHANNEL_ID, "text": text},
        )
        data = r.json()
        if not data.get("ok"):
            raise RuntimeError(f"Slack error: {data.get('error')}")
