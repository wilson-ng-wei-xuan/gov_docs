from enum import Enum
from typing import List, Union, Dict
from pydantic import BaseModel
from schema.open_redirect import OpenRedirectParamResult
from schema.xss import XSSParamResult
from schema.xxe import XXEResult
from schema.sqli import SQLiResult

class ResultType(str, Enum):
    BASIC = "Basic"
    ADVANCED = "Advanced"

class ParamResultList(BaseModel):
    param_result_list: List[Union[XSSParamResult, OpenRedirectParamResult, XXEResult, SQLiResult]]

class FinalParamResult(BaseModel):
    result_type: ResultType
    param_result_list: ParamResultList

class FinalTestingResult(BaseModel):
    endpoint: str
    final_param_result_list: Dict[str, List[FinalParamResult]]
