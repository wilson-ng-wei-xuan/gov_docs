from enum import Enum
from pydantic import BaseModel, RootModel
from schema.request_response import RequestResponsePair
from typing import Dict, List, Optional
from schema.task import VulnType
from schema.xss import XSSType
from schema.open_redirect import RedirectType
from schema.xxe import XXEType
from schema.sqli import SQLiType
from typing import Union

class Result(Enum):
    POTENTIAL = "Potential"

class ValidatorResult(BaseModel):
    vulnerability: VulnType
    type: List[Union[XSSType, RedirectType, SQLiType, XXEType]]
    vulnerable: Union[bool, Result]
    param: Optional[Union[str, bytes]]
    payload: Optional[Union[str, bytes]]
    request_response: RequestResponsePair
    notes: Optional[str]

class ValidatorResultList(RootModel[List[ValidatorResult]]):
    pass