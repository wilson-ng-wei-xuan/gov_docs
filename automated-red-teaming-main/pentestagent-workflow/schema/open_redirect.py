from enum import Enum
from typing import Optional
from pydantic import BaseModel


class RedirectType(str, Enum):
    LOCATION_HEADER = "location_header"
    META_REFRESH = "meta_refresh"
    WINDOW_LOCATION = "window.location"
    WINDOW_OPEN = "window.open"
    DOCUMENT_LOCATION = "document.location"
    REFRESH_HEADER = "refresh_header"
    BROWSER_FINAL_URL = "browser_final_url"
    WEBHOOK_REQUEST = "webhook_request"
    WEBHOOK_BROWSER = "webhook_browser"
    BROWSER_DOM = "browser_dom"
    HREF = "href"
    NOT_VULNERABLE = "Not vulnerable"
    ERROR = "Error"
    BODY_REFLECTION = "Body reflection"

class OpenRedirectParamResult(BaseModel):
    endpoint_url: str
    method: str
    param: str
    payload: str
    potentially_vulnerable: bool
    redirect_type: RedirectType
    notes: Optional[str] = None

