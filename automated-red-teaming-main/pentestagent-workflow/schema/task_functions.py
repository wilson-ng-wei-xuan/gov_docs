from typing import Callable, Dict, Union

from tools.katana import run_katana
from custom_agents.dorking.dorking import run_dorking_agent
from custom_agents.recon.fingerprint import run_fingerprint_agent
from custom_agents.recon.recon import run_recon_agent
from custom_agents.xss.xss_agent import run_xss_agent
from custom_agents.xxe.xxe_agent import run_xxe_agent
from custom_agents.open_redirect.open_redirect_agent import run_open_redirect_agent
from custom_agents.sqli.sqli_agent import run_sqli_agent
from custom_agents.attack_mapper.attack_mapper import run_attack_mapper_agent
from schema.task import WorkflowStage

TASK_FUNCTIONS: Dict[Union[WorkflowStage, str], Callable] = {
    WorkflowStage.run_katana: run_katana,
    WorkflowStage.run_dorking_agent: run_dorking_agent,
    WorkflowStage.run_fingerprint_agent: run_fingerprint_agent,
    WorkflowStage.run_recon_agent: run_recon_agent,
    WorkflowStage.run_xss_agent: run_xss_agent,
    WorkflowStage.run_open_redirect_agent: run_open_redirect_agent,
    WorkflowStage.run_xxe_agent: run_xxe_agent,
    WorkflowStage.run_sqli_agent: run_sqli_agent,
    WorkflowStage.run_attack_mapper_agent: run_attack_mapper_agent,
}