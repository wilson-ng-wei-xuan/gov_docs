from enum import Enum
from pydantic import BaseModel

class XXEType(Enum):
    FILE_READ = "FILE_READ"
    PARSER_ERROR = "PARSER_ERROR"
    REFLECTION = "REFLECTION"
    WEBHOOK = "WEBHOOK"
    XML_HEADER = "XML_HEADER"
    NOT_VULNERABLE = "NOT_VULNERABLE"
    ERROR = "ERROR"

class Severity(str, Enum):
    HIGH = "HIGH"
    MEDIUM = "MEDIUM"
    LOW = "LOW"

class XXEResult(BaseModel):
    endpoint_url: str
    method: str
    param: str
    payload: str
    vulnerable: bool
    severity: Severity  # high, medium, low
    detection_method: XXEType  # file_read, parser_error, reflection
    notes: str
